<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador de Mensalidades com Nota ENEM</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Lato', sans-serif;
    }

    body {
      margin: 0;
      padding: 20px;
      background: linear-gradient(to bottom right, #1e3c72, #2a5298);
      display: flex;
      justify-content: center;
      min-height: 100vh;
      color: #333;
    }

    .form-container {
      background: rgba(255, 255, 255, 0.95);
      padding: 25px;
      max-width: 500px;
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
    }

    h2 {
      color: #1e3c72;
      text-align: center;
      margin-bottom: 25px;
    }

    input, select, button {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    button {
      background-color: #1e3c72;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-top: 20px;
      padding: 14px;
    }

    button:hover {
      background-color: #2a5298;
    }

    .resultado {
      margin-top: 25px;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #1e3c72;
    }

    .notas-enem {
      margin-top: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .notas-enem div {
      display: flex;
      flex-direction: column;
    }

    .notas-enem label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      font-size: 14px;
    }

    .notas-enem input {
      width: 100%;
      padding: 10px;
    }

    .whatsapp-btn {
      display: block;
      text-align: center;
      background-color: #25D366;
      color: white;
      text-decoration: none;
      padding: 14px;
      border-radius: 6px;
      margin-top: 20px;
      font-weight: bold;
    }

    .whatsapp-btn:hover {
      background-color: #128C7E;
    }
  </style>
</head>
<body>

  <div class="form-container">
    <h2>Simulador de Mensalidades com Nota ENEM</h2>
    
    <form id="formSimulacao">
      <label for="nome">Nome Completo:</label>
      <input type="text" id="nome" placeholder="Seu nome completo" required>
      
      <label for="telefone">Telefone:</label>
      <input type="tel" id="telefone" placeholder="(99) 99999-9999" required>
      
      <label for="cpf">CPF:</label>
      <input type="text" id="cpf" placeholder="999.999.999-99" required>
      
      <label for="curso">Curso desejado:</label>
      <select id="curso" required>
        <option value="">Selecione seu curso</option>
        <option value="administracao" data-valor-bruto="1028.29" data-valor-mensalidade="462.73">GRADUAÇÃO EM ADMINISTRAÇÃO (NOTURNO)</option>
        <option value="agronomia" data-valor-bruto="2200.21" data-valor-mensalidade="792.08">GRADUAÇÃO EM AGRONOMIA (NOTURNO)</option>
        <option value="arquitetura" data-valor-bruto="1937.13" data-valor-mensalidade="697.37">GRADUAÇÃO EM ARQUITETURA E URBANISMO</option>
        <option value="biomedicina-matutino" data-valor-bruto="2116.51" data-valor-mensalidade="761.94">GRADUAÇÃO EM BIOMEDICINA (MATUTINO)</option>
        <option value="biomedicina-noturno" data-valor-bruto="1841.46" data-valor-mensalidade="828.66">GRADUAÇÃO EM BIOMEDICINA (NOTURNO)</option>
        <option value="ciencias-contabeis" data-valor-bruto="932.63" data-valor-mensalidade="419.68">GRADUAÇÃO EM CIÊNCIAS CONTÁBEIS (NOTURNO)</option>
        <option value="publicidade" data-valor-bruto="1387.04" data-valor-mensalidade="624.17">GRADUAÇÃO EM PUBLICIDADE E PROPAGANDA (NOTURNO)</option>
        <option value="direito-matutino" data-valor-bruto="2056.72" data-valor-mensalidade="740.42">GRADUAÇÃO EM DIREITO (MATUTINO)</option>
        <option value="direito-noturno" data-valor-bruto="1793.63" data-valor-mensalidade="645.71">GRADUAÇÃO EM DIREITO (NOTURNO)</option>
        <option value="enfermagem" data-valor-bruto="2152.38" data-valor-mensalidade="774.86">GRADUAÇÃO EM ENFERMAGEM (NOTURNO)</option>
        <option value="engenharia-civil" data-valor-bruto="1889.30" data-valor-mensalidade="680.15">GRADUAÇÃO EM ENGENHARIA CIVIL (NOTURNO)</option>
        <option value="engenharia-software" data-valor-bruto="1674.04" data-valor-mensalidade="753.32">GRADUAÇÃO EM ENGENHARIA DE SOFTWARE (NOTURNO)</option>
        <option value="engenharia-mecanica" data-valor-bruto="2056.72" data-valor-mensalidade="832.97">GRADUAÇÃO EM ENGENHARIA MECÂNICA (NOTURNO)</option>
        <option value="farmacia" data-valor-bruto="1745.79" data-valor-mensalidade="785.61">GRADUAÇÃO EM FARMÁCIA (NOTURNO)</option>
        <option value="fisioterapia-matutino" data-valor-bruto="1931.16" data-valor-mensalidade="695.22">GRADUAÇÃO EM FISIOTERAPIA (MATUTINO)</option>
        <option value="fisioterapia-noturno" data-valor-bruto="2032.79" data-valor-mensalidade="914.76">GRADUAÇÃO EM FISIOTERAPIA (NOTURNO)</option>
        <option value="medicina-veterinaria" data-valor-bruto="4520.13" data-valor-mensalidade="1627.25">GRADUAÇÃO EM MEDICINA VETERINÁRIA (MATUTINO)</option>
        <option value="nutricao" data-valor-bruto="1793.63" data-valor-mensalidade="807.13">GRADUAÇÃO EM NUTRIÇÃO (NOTURNO)</option>
        <option value="odontologia" data-valor-bruto="5082.17" data-valor-mensalidade="1829.58">GRADUAÇÃO EM ODONTOLOGIA (MATUTINO)</option>
        <option value="pedagogia" data-valor-bruto="855.26" data-valor-mensalidade="384.87">GRADUAÇÃO EM PEDAGOGIA (NOTURNO)</option>
        <option value="psicologia-matutino" data-valor-bruto="2612.77" data-valor-mensalidade="940.60">GRADUAÇÃO EM PSICOLOGIA (MATUTINO)</option>
        <option value="psicologia-noturno" data-valor-bruto="2271.96" data-valor-mensalidade="817.91">GRADUAÇÃO EM PSICOLOGIA (NOTURNO)</option>
        <option value="ads" data-valor-bruto="956.55" data-valor-mensalidade="430.45">SUPERIOR DE TECNOLOGIA EM ANÁLISE E DESENVOLVIMENTO DE SISTEMAS (NOTURNO)</option>
        <option value="estetica" data-valor-bruto="1291.38" data-valor-mensalidade="581.12">SUPERIOR DE TECNOLOGIA EM ESTÉTICA E COSMÉTICA (NOTURNO)</option>
        <option value="processos-gerenciais" data-valor-bruto="908.71" data-valor-mensalidade="408.92">SUPERIOR DE TECNOLOGIA EM PROCESSOS GERENCIAIS (NOTURNO)</option>
      </select>

      <div class="notas-enem">
        <div>
          <label for="nota-linguagens">Linguagem, Códigos e suas tecnologias:</label>
          <input type="number" id="nota-linguagens" min="0" max="1000" step="0.1" required>
        </div>
        <div>
          <label for="nota-matematica">Matemática e suas tecnologias:</label>
          <input type="number" id="nota-matematica" min="0" max="1000" step="0.1" required>
        </div>
        <div>
          <label for="nota-humanas">Ciências Humanas e suas tecnologias:</label>
          <input type="number" id="nota-humanas" min="0" max="1000" step="0.1" required>
        </div>
        <div>
          <label for="nota-natureza">Ciências da Natureza e suas tecnologias:</label>
          <input type="number" id="nota-natureza" min="0" max="1000" step="0.1" required>
        </div>
        <div>
          <label for="nota-redacao">Redação:</label>
          <input type="number" id="nota-redacao" min="0" max="1000" step="0.1" required>
        </div>
      </div>

      <button type="submit">Calcular Mensalidades</button>
    </form>

    <div class="resultado" id="resultado"></div>
  </div>

  <script>
    // Máscaras para telefone e CPF
    document.getElementById("telefone").addEventListener("input", function(e) {
      e.target.value = e.target.value
        .replace(/\D/g, '')
        .replace(/(\d{2})(\d)/, '($1) $2')
        .replace(/(\d{5})(\d)/, '$1-$2');
    });

    document.getElementById("cpf").addEventListener("input", function(e) {
      e.target.value = e.target.value
        .replace(/\D/g, '')
        .replace(/(\d{3})(\d)/, '$1.$2')
        .replace(/(\d{3})(\d)/, '$1.$2')
        .replace(/(\d{3})(\d)/, '$1-$2');
    });

    async function enviarParaGoogleSheets(dados) {
      const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbyRgslBzu_fNFJd-cs04HlaBIxL-AcnkE3yry28gX35ynWXbV1BBqZ96wXmiGEi0m0pqA/exec";
      
      try {
        const response = await fetch(URL_SCRIPT, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(dados),
          mode: 'no-cors'
        });
        
        console.log('Dados enviados para o Google Sheets');
        return true;
      } catch (error) {
        console.error('Erro ao enviar dados:', error);
        return false;
      }
    }

    function formatarMoeda(valor) {
      return valor.toLocaleString('pt-BR', {
        style: 'currency',
        currency: 'BRL',
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
    }

    function calcularDescontoCascata(valor, descontoPrincipal, descontoAdicional) {
      let valorComDesconto = valor * (1 - (descontoPrincipal / 100));
      valorComDesconto = valorComDesconto * (1 - (descontoAdicional / 100));
      return valorComDesconto;
    }

    async function calcularMensalidades() {
      // Dados pessoais
      const nome = document.getElementById("nome").value;
      const telefone = document.getElementById("telefone").value;
      const cpf = document.getElementById("cpf").value;
      
      // Notas ENEM
      const notas = {
        linguagens: parseFloat(document.getElementById("nota-linguagens").value),
        matematica: parseFloat(document.getElementById("nota-matematica").value),
        humanas: parseFloat(document.getElementById("nota-humanas").value),
        natureza: parseFloat(document.getElementById("nota-natureza").value),
        redacao: parseFloat(document.getElementById("nota-redacao").value)
      };
      
      // Verificar se todas as notas são válidas
      for (const [key, value] of Object.entries(notas)) {
        if (isNaN(value) || value <= 0 || value > 1000) {
          alert(`Por favor, insira uma nota válida (entre 1 e 1000) para ${key}`);
          return;
        }
      }
      
      // Curso selecionado
      const cursoSelect = document.getElementById("curso");
      const curso = cursoSelect.options[cursoSelect.selectedIndex].text;
      const valorBruto = parseFloat(cursoSelect.options[cursoSelect.selectedIndex].dataset.valorBruto);
      const primeiraMensalidade = parseFloat(cursoSelect.options[cursoSelect.selectedIndex].dataset.valorMensalidade);
      
      // Calcular média ENEM
      const mediaEnem = (notas.linguagens + notas.matematica + notas.humanas + notas.natureza + notas.redacao) / 5;
      
      // Definir descontos conforme a média
      let descontoPrincipal = 0;
      let descontoAdicional = 10;
      
      if (mediaEnem >= 901) {
        descontoPrincipal = 100;
        descontoAdicional = 0;
      } else if (mediaEnem >= 801) {
        descontoPrincipal = 70;
      } else if (mediaEnem >= 601) {
        descontoPrincipal = 65;
      } else if (mediaEnem >= 400) {
        descontoPrincipal = 55;
      }
      
      // Calcular valor com desconto
      let valorComDesconto = calcularDescontoCascata(valorBruto, descontoPrincipal, descontoAdicional);
      
      // Ajustar valor se necessário
      if (mediaEnem < 400 || valorComDesconto > primeiraMensalidade) {
        valorComDesconto = primeiraMensalidade;
      }
      
      // Montar mensagem de resultado
      let resultadoHTML = `
        <h3>Resultado da Simulação</h3>
        <p><strong>Curso:</strong> ${curso}</p>
        <p><strong>1ª mensalidade:</strong> ${formatarMoeda(primeiraMensalidade)}</p>
        <p><strong>Demais mensalidades:</strong> ${formatarMoeda(valorComDesconto)}</p>
        <p><strong>Média ENEM:</strong> ${mediaEnem.toFixed(1)} pontos</p>
        
        <a href="https://wa.me/5542999457158?text=Olá,%20meu%20nome%20é%20${encodeURIComponent(nome)}.%20Gostaria%20de%20me%20matricular%20no%20curso%20de%20${encodeURIComponent(curso)}.%20Simulação:%201ª%20mensalidade%20${formatarMoeda(primeiraMensalidade)}%20|%20Demais%20mensalidades%20${formatarMoeda(valorComDesconto)}%20|%20Média%20ENEM:%20${mediaEnem.toFixed(1)}" class="whatsapp-btn">
          Quero me matricular via WhatsApp
        </a>
      `;
      
      // Exibir resultados
      document.getElementById("resultado").innerHTML = resultadoHTML;
      
      // Preparar dados para envio ao Google Sheets
      const dadosParaEnvio = {
        nome: nome,
        telefone: telefone,
        cpf: cpf,
        curso: curso,
        nota_linguagens: notas.linguagens,
        nota_matematica: notas.matematica,
        nota_humanas: notas.humanas,
        nota_natureza: notas.natureza,
        nota_redacao: notas.redacao,
        media_enem: mediaEnem.toFixed(1),
        data: new Date().toISOString()
      };
      
      // Enviar dados para o Google Sheets
      const enviadoComSucesso = await enviarParaGoogleSheets(dadosParaEnvio);
      if (!enviadoComSucesso) {
        alert("Os dados da simulação não puderam ser salvos. Por favor, entre em contato conosco.");
      }
    }

    // Configurar o evento de submit do formulário
    document.getElementById("formSimulacao").addEventListener("submit", function(e) {
      e.preventDefault();
      calcularMensalidades();
    });
  </script>
</body>
</html>